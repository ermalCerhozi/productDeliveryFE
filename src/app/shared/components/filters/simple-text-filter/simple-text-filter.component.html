<ng-template>
    <form [formGroup]="form" class="mef-simple-text-filter" [hidden]="disabled()">
        <mat-form-field
            floatLabel="auto"
            class="form-field-without-hint"
            [ngStyle]="{
                backgroundColor:
                    form.get('fields')?.value?.length || form.get('fields')?.value?.value
                        ? '#dcdcdc'
                        : '#eeeeee',
                width: customLabelWidth() ? customLabelWidth() : null,
            }"
        >
            <span class="mef-simple-text-label">
                @if (showCheck !== undefined) {
                    @if (showCheck()) {
                        <mat-icon class="mef-simple-text-label-icon">check</mat-icon>
                    }
                } @else {
                    @if (form && form.value.fields.length > 0) {
                        <mat-icon class="mef-simple-text-label-icon">check</mat-icon>
                    }
                }
                <span>{{ labelTK }}</span>
            </span>
            <!-- [mefTrackBy]="field.charAt(0).toUpperCase() + field.slice(1) + 'FilterClicked'" //TODO: detemine if needed -->
            <mat-select
                formControlName="fields"
                [multiple]="multiple"
                (selectionChange)="onSelectionChange()"
                (openedChange)="onOpenedChange($event)"
                class="mef-simple-text-filter-select"
                data-testid="filter-select"
                [panelClass]="['mef-simple-text-filter-select-overlay', panelClass()]"
                [compareWith]="compareValues"
                [disableOptionCentering]="true"
            >
                @if (loading()) {
                    <mat-option class="spinner-option">
                        <mat-spinner diameter="30"></mat-spinner>
                    </mat-option>
                }
                @if (hasAllOption && allOption && !loading) {
                    <mat-option
                        data-testid="all-option"
                        [disabled]="isAllSelected"
                        [value]="allOption"
                    >
                        <div class="mef-simple-text-filter-content">
                            <div class="label">
                                @if (allOption.isTranslated) {
                                    {{ allOption.label }}
                                }
                                @if (!allOption.isTranslated) {
                                    {{ allOption.label }}
                                }
                            </div>
                            @if (allOption.count || allOption.count === 0) {
                                <div class="count">({{ allOption.count }})</div>
                            }
                        </div>
                    </mat-option>
                }
                <!-- All other options -->
                @for (field of optionsWithoutAll; track field) {
                    <mat-option [value]="field">
                        <div class="mef-simple-text-filter-content">
                            <div class="label">
                                @if (field.isTranslated) {
                                    {{ field.label }}
                                }
                                @if (!field.isTranslated) {
                                    {{ field.label }}
                                }
                            </div>
                            @if (hasOnlyButton) {
                                <button
                                    class="only-button"
                                    color="primary"
                                    data-testid="only-button"
                                    mat-icon-button
                                    (click)="selectOnlyOne($event, field)"
                                >
                                    {{ 'GT_ONLY' }}
                                </button>
                            }
                            @if (field.count || field.count === 0) {
                                <div class="count">({{ field.count }})</div>
                            }
                        </div>
                    </mat-option>
                }
            </mat-select>
        </mat-form-field>
    </form>
</ng-template>
