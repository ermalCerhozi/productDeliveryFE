<ng-container *transloco="let t">
    <mat-tab-group class="permissions-tab-group" animationDuration="0ms">
        <mat-tab [label]="t('managePermissions.managePermissionsTab')">
            <mat-card class="permission-form-card">
                <form [formGroup]="form" (ngSubmit)="onSubmit()" class="permission-form">
                    <div class="form-row">
                        <mat-form-field appearance="outline" class="form-field">
                            <mat-label>{{ t('managePermissions.code') }}</mat-label>
                            <input matInput formControlName="code" [placeholder]="t('managePermissions.codePlaceholder')" autocomplete="off" />
                            @if (form.get('code')?.hasError('required')) {
                            <mat-error> {{ t('managePermissions.codeRequired') }} </mat-error>
                            }
                            @if (form.get('code')?.hasError('maxlength')) {
                            <mat-error> {{ t('managePermissions.codeMaxLength') }} </mat-error>
                            }
                        </mat-form-field>
                    </div>

                    <div class="form-row">
                        <mat-form-field appearance="outline" class="form-field">
                            <mat-label>{{ t('managePermissions.description') }}</mat-label>
                            <textarea matInput formControlName="description" rows="3"
                                [placeholder]="t('managePermissions.descriptionPlaceholder')"></textarea>
                            <mat-hint align="end">
                                {{ form.get('description')?.value?.length || 0 }}/255
                            </mat-hint>
                            @if (form.get('description')?.hasError('maxlength')) {
                            <mat-error> {{ t('managePermissions.descriptionMaxLength') }} </mat-error>
                            }
                        </mat-form-field>
                    </div>

                    <div class="actions">
                        <button mat-raised-button color="primary" type="submit" [disabled]="form.invalid">
                            {{ t('managePermissions.addPermission') }}
                        </button>
                    </div>
                </form>
            </mat-card>

            <mat-card class="permissions-list-card">
                <app-top-bar [mediaCount]="(tableData$ | async)?.length || 0" [title]="t('managePermissions.permissions')"
                    [placeholder]="t('managePermissions.searchPermissions')" [displayAddButton]="false"
                    (searchOptionsChange)="onOptionsChanged($event)" (search)="onSearch($event)"
                    (addItem)="addPermission()"></app-top-bar>

                <app-table [data]="(tableData$ | async) || []" [columns]="tableColumns()" [searchQuery]="searchQuery()"
                    [isSelectable]="false" [showActions]="false" (onEdit)="onEdit($event)" (onDelete)="onDelete($event)" >
                </app-table>
            </mat-card>
        </mat-tab>

        <mat-tab [label]="t('managePermissions.assignPermissionsTab')">
            <app-assign-permissions></app-assign-permissions>
        </mat-tab>
    </mat-tab-group>
</ng-container>